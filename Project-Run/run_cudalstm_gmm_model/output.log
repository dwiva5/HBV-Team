2024-01-29 14:46:31,804: Logging to /workspace/hbv-runoff/Project-Run/runs/run_cudalstm_2901_144631/output.log initialized.
2024-01-29 14:46:31,805: ### Folder structure created at /workspace/hbv-runoff/Project-Run/runs/run_cudalstm_2901_144631
2024-01-29 14:46:31,805: ### Run configurations for run_cudalstm
2024-01-29 14:46:31,805: experiment_name: run_cudalstm
2024-01-29 14:46:31,805: train_basin_file: basin_huc_17.txt
2024-01-29 14:46:31,806: validation_basin_file: basin_huc_17.txt
2024-01-29 14:46:31,806: test_basin_file: basin_huc_17.txt
2024-01-29 14:46:31,806: train_start_date: 1980-01-01 00:00:00
2024-01-29 14:46:31,806: train_end_date: 1999-12-31 00:00:00
2024-01-29 14:46:31,807: validation_start_date: 2000-01-01 00:00:00
2024-01-29 14:46:31,807: validation_end_date: 2004-12-31 00:00:00
2024-01-29 14:46:31,807: test_start_date: 2005-01-01 00:00:00
2024-01-29 14:46:31,808: test_end_date: 2009-12-31 00:00:00
2024-01-29 14:46:31,808: device: cuda:0
2024-01-29 14:46:31,808: validate_every: 3
2024-01-29 14:46:31,808: validate_n_random_basins: 91
2024-01-29 14:46:31,809: metrics: ['NSE']
2024-01-29 14:46:31,809: model: cudalstm
2024-01-29 14:46:31,809: head: gmm
2024-01-29 14:46:31,809: output_activation: linear
2024-01-29 14:46:31,810: hidden_size: 20
2024-01-29 14:46:31,810: n_distributions: 10
2024-01-29 14:46:31,810: negative_sample_handling: clip
2024-01-29 14:46:31,810: mc_dropout: False
2024-01-29 14:46:31,811: n_samples: 20
2024-01-29 14:46:31,811: output_dropout: 0.4
2024-01-29 14:46:31,811: optimizer: Adam
2024-01-29 14:46:31,811: loss: GMMLoss
2024-01-29 14:46:31,812: learning_rate: {0: 0.001, 30: 0.005, 40: 0.001}
2024-01-29 14:46:31,812: batch_size: 256
2024-01-29 14:46:31,812: epochs: 50
2024-01-29 14:46:31,812: clip_gradient_norm: 1
2024-01-29 14:46:31,813: predict_last_n: 1
2024-01-29 14:46:31,813: seq_length: 365
2024-01-29 14:46:31,813: num_workers: 8
2024-01-29 14:46:31,813: log_interval: 5
2024-01-29 14:46:31,814: log_tensorboard: True
2024-01-29 14:46:31,814: log_n_figures: 1
2024-01-29 14:46:31,814: save_weights_every: 1
2024-01-29 14:46:31,814: dataset: camels_us
2024-01-29 14:46:31,814: data_dir: ../data/CAMELS_US
2024-01-29 14:46:31,814: forcings: ['maurer', 'daymet', 'nldas']
2024-01-29 14:46:31,815: dynamic_inputs: ['PRCP(mm/day)_nldas', 'PRCP(mm/day)_maurer', 'prcp(mm/day)_daymet', 'srad(W/m2)_daymet', 'tmax(C)_daymet', 'tmin(C)_daymet', 'vp(Pa)_daymet']
2024-01-29 14:46:31,815: target_variables: ['QObs(mm/d)']
2024-01-29 14:46:31,815: clip_targets_to_zero: ['QObs(mm/d)']
2024-01-29 14:46:31,815: static_attributes: ['elev_mean', 'slope_mean', 'area_gages2', 'frac_forest', 'lai_max', 'lai_diff', 'gvf_max', 'gvf_diff', 'soil_depth_pelletier', 'soil_depth_statsgo', 'soil_porosity', 'soil_conductivity', 'max_water_content', 'sand_frac', 'silt_frac', 'clay_frac', 'carbonate_rocks_frac', 'geol_permeability', 'p_mean', 'pet_mean', 'aridity', 'frac_snow', 'high_prec_freq', 'high_prec_dur', 'low_prec_freq', 'low_prec_dur']
2024-01-29 14:46:31,815: number_of_basins: 91
2024-01-29 14:46:31,815: run_dir: /workspace/hbv-runoff/Project-Run/runs/run_cudalstm_2901_144631
2024-01-29 14:46:31,816: train_dir: /workspace/hbv-runoff/Project-Run/runs/run_cudalstm_2901_144631/train_data
2024-01-29 14:46:31,816: img_log_dir: /workspace/hbv-runoff/Project-Run/runs/run_cudalstm_2901_144631/img_log
2024-01-29 14:46:31,850: ### Device cuda:0 will be used for training
2024-01-29 14:46:31,873: Loading basin data into xarray data set.
2024-01-29 14:46:37,620: Create lookup table and convert to pytorch tensor
2024-01-29 14:46:56,021: Epoch 1 average loss: avg_loss: -0.47558, avg_total_loss: -0.47558
2024-01-29 14:47:09,625: Epoch 2 average loss: avg_loss: -0.86529, avg_total_loss: -0.86529
2024-01-29 14:47:23,174: Epoch 3 average loss: avg_loss: -1.00963, avg_total_loss: -1.00963
2024-01-29 14:47:38,840: Epoch 3 average validation loss: 0.18006 -- Median validation metrics: avg_loss: 0.18006, NSE: 0.73733
2024-01-29 14:47:52,100: Epoch 4 average loss: avg_loss: -1.10057, avg_total_loss: -1.10057
2024-01-29 14:48:05,317: Epoch 5 average loss: avg_loss: -1.16295, avg_total_loss: -1.16295
2024-01-29 14:48:18,602: Epoch 6 average loss: avg_loss: -1.21724, avg_total_loss: -1.21724
2024-01-29 14:48:26,367: Epoch 6 average validation loss: 1.44935 -- Median validation metrics: avg_loss: 1.44935, NSE: 0.60946
2024-01-29 14:48:39,628: Epoch 7 average loss: avg_loss: -1.25533, avg_total_loss: -1.25533
2024-01-29 14:48:52,914: Epoch 8 average loss: avg_loss: -1.28560, avg_total_loss: -1.28560
2024-01-29 14:49:06,219: Epoch 9 average loss: avg_loss: -1.30437, avg_total_loss: -1.30437
2024-01-29 14:49:13,986: Epoch 9 average validation loss: 1.38734 -- Median validation metrics: avg_loss: 1.38734, NSE: 0.59845
2024-01-29 14:49:27,354: Epoch 10 average loss: avg_loss: -1.32891, avg_total_loss: -1.32891
2024-01-29 14:49:40,482: Epoch 11 average loss: avg_loss: -1.34977, avg_total_loss: -1.34977
2024-01-29 14:49:53,710: Epoch 12 average loss: avg_loss: -1.36135, avg_total_loss: -1.36135
2024-01-29 14:50:01,513: Epoch 12 average validation loss: 2.21050 -- Median validation metrics: avg_loss: 2.21050, NSE: 0.60211
2024-01-29 14:50:14,677: Epoch 13 average loss: avg_loss: -1.37356, avg_total_loss: -1.37356
2024-01-29 14:50:27,897: Epoch 14 average loss: avg_loss: -1.38508, avg_total_loss: -1.38508
2024-01-29 14:50:40,931: Epoch 15 average loss: avg_loss: -1.39495, avg_total_loss: -1.39495
2024-01-29 14:50:48,986: Epoch 15 average validation loss: 2.21209 -- Median validation metrics: avg_loss: 2.21209, NSE: 0.56179
2024-01-29 14:51:02,553: Epoch 16 average loss: avg_loss: -1.40140, avg_total_loss: -1.40140
2024-01-29 14:51:15,900: Epoch 17 average loss: avg_loss: -1.41228, avg_total_loss: -1.41228
2024-01-29 14:51:29,300: Epoch 18 average loss: avg_loss: -1.42180, avg_total_loss: -1.42180
2024-01-29 14:51:36,973: Epoch 18 average validation loss: 2.31677 -- Median validation metrics: avg_loss: 2.31677, NSE: 0.57905
2024-01-29 14:51:50,211: Epoch 19 average loss: avg_loss: -1.42729, avg_total_loss: -1.42729
2024-01-29 14:52:03,555: Epoch 20 average loss: avg_loss: -1.43653, avg_total_loss: -1.43653
2024-01-29 14:52:16,802: Epoch 21 average loss: avg_loss: -1.43644, avg_total_loss: -1.43644
2024-01-29 14:52:24,578: Epoch 21 average validation loss: 2.44641 -- Median validation metrics: avg_loss: 2.44641, NSE: 0.55008
2024-01-29 14:52:37,931: Epoch 22 average loss: avg_loss: -1.44417, avg_total_loss: -1.44417
2024-01-29 14:52:51,278: Epoch 23 average loss: avg_loss: -1.45234, avg_total_loss: -1.45234
2024-01-29 14:53:04,633: Epoch 24 average loss: avg_loss: -1.45375, avg_total_loss: -1.45375
2024-01-29 14:53:12,389: Epoch 24 average validation loss: 2.26123 -- Median validation metrics: avg_loss: 2.26123, NSE: 0.59757
2024-01-29 14:53:25,659: Epoch 25 average loss: avg_loss: -1.45732, avg_total_loss: -1.45732
2024-01-29 14:53:39,001: Epoch 26 average loss: avg_loss: -1.46476, avg_total_loss: -1.46476
2024-01-29 14:53:52,255: Epoch 27 average loss: avg_loss: -1.47032, avg_total_loss: -1.47032
2024-01-29 14:54:00,390: Epoch 27 average validation loss: 3.16680 -- Median validation metrics: avg_loss: 3.16680, NSE: 0.57219
2024-01-29 14:54:13,814: Epoch 28 average loss: avg_loss: -1.46917, avg_total_loss: -1.46917
2024-01-29 14:54:27,152: Epoch 29 average loss: avg_loss: -1.47299, avg_total_loss: -1.47299
2024-01-29 14:54:27,154: Setting learning rate to 0.005
2024-01-29 14:54:40,303: Epoch 30 average loss: avg_loss: -1.19494, avg_total_loss: -1.19494
2024-01-29 14:54:48,081: Epoch 30 average validation loss: 1.07037 -- Median validation metrics: avg_loss: 1.07037, NSE: 0.64636
2024-01-29 14:55:01,363: Epoch 31 average loss: avg_loss: -1.22747, avg_total_loss: -1.22747
2024-01-29 14:55:14,701: Epoch 32 average loss: avg_loss: -1.24844, avg_total_loss: -1.24844
2024-01-29 14:55:27,966: Epoch 33 average loss: avg_loss: -1.27612, avg_total_loss: -1.27612
2024-01-29 14:55:35,784: Epoch 33 average validation loss: 1.09674 -- Median validation metrics: avg_loss: 1.09674, NSE: 0.59067
2024-01-29 14:55:48,954: Epoch 34 average loss: avg_loss: -1.29428, avg_total_loss: -1.29428
2024-01-29 14:56:02,204: Epoch 35 average loss: avg_loss: -1.30686, avg_total_loss: -1.30686
2024-01-29 14:56:15,409: Epoch 36 average loss: avg_loss: -1.31854, avg_total_loss: -1.31854
2024-01-29 14:56:23,174: Epoch 36 average validation loss: 0.99797 -- Median validation metrics: avg_loss: 0.99797, NSE: 0.61625
2024-01-29 14:56:36,504: Epoch 37 average loss: avg_loss: -1.32890, avg_total_loss: -1.32890
2024-01-29 14:56:50,004: Epoch 38 average loss: avg_loss: -1.33393, avg_total_loss: -1.33393
2024-01-29 14:57:03,512: Epoch 39 average loss: avg_loss: -1.34698, avg_total_loss: -1.34698
2024-01-29 14:57:11,284: Epoch 39 average validation loss: 0.69624 -- Median validation metrics: avg_loss: 0.69624, NSE: 0.62624
2024-01-29 14:57:11,284: Setting learning rate to 0.001
2024-01-29 14:57:25,866: Epoch 40 average loss: avg_loss: -1.50324, avg_total_loss: -1.50324
2024-01-29 14:57:40,064: Epoch 41 average loss: avg_loss: -1.52006, avg_total_loss: -1.52006
2024-01-29 14:57:54,224: Epoch 42 average loss: avg_loss: -1.52722, avg_total_loss: -1.52722
2024-01-29 14:58:02,389: Epoch 42 average validation loss: 1.67047 -- Median validation metrics: avg_loss: 1.67047, NSE: 0.60466
2024-01-29 14:58:15,705: Epoch 43 average loss: avg_loss: -1.53233, avg_total_loss: -1.53233
2024-01-29 14:58:29,224: Epoch 44 average loss: avg_loss: -1.53418, avg_total_loss: -1.53418
2024-01-29 14:58:42,804: Epoch 45 average loss: avg_loss: -1.53950, avg_total_loss: -1.53950
2024-01-29 14:58:50,578: Epoch 45 average validation loss: 2.08272 -- Median validation metrics: avg_loss: 2.08272, NSE: 0.62415
2024-01-29 14:59:03,862: Epoch 46 average loss: avg_loss: -1.54329, avg_total_loss: -1.54329
2024-01-29 14:59:17,303: Epoch 47 average loss: avg_loss: -1.54460, avg_total_loss: -1.54460
2024-01-29 14:59:30,606: Epoch 48 average loss: avg_loss: -1.54828, avg_total_loss: -1.54828
2024-01-29 14:59:38,290: Epoch 48 average validation loss: 2.23073 -- Median validation metrics: avg_loss: 2.23073, NSE: 0.61373
2024-01-29 14:59:51,606: Epoch 49 average loss: avg_loss: -1.54967, avg_total_loss: -1.54967
2024-01-29 15:00:04,907: Epoch 50 average loss: avg_loss: -1.55317, avg_total_loss: -1.55317
